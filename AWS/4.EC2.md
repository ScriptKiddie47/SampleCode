# Elastic Compute Cloud ( EC2 )

## EC2 Pricing Options

1. On Demand -> Pay by the hour / second
    - ✅ Flexible -> Low Cost & flexibility of amazon EC2 without any upfront payment
    - ✅ Short-Term -> Spiky or unpredictable workloads
    - ✅ Testing the water
1. Reserved -> Reserved Capacity for 1-3 yrs2. Upto 72% discount
    - ✅ Predictable Usage
    - ✅ Specific Capacity Requirement
    - ✅ Pay up front
    - ✅ Covertible RI's
    - ✅ Scheduled RI's -> Launch within the time window you define. Match you capacity reservation to a predictable recurring schedule
    - 🛑 operate at a regional level 
1. Spot -> Purchase unused capacity at a discount upoto 90%
    - 🛑 No Garunteed uptime
    - ✅ Applications that have flexible start and end time
    - ❎ Bad for web servers
    - ✅ Feasible at very low compute prices
    - 🛑 Image Rendering, Genomic sequencing , Alogirthm trading engine.
1. Dedicated -> Physical EC2 server [ Expensive ]
    - ✅ Compliance -> Regulatory environment that may not support multi-tenant virtualization
    - ✅ Licensing
    - ✅ Can be purchased on-demand
    - ✅ Reserved 



## Security Groups

1. Virtual Firewalls for EC2 Instances. By default everything is blocked.
1. In order to able to communicate to your ec2 instances via SSH/RDP/HTTP/HTTPS , you need to open up the correct ports
1. Lets create a new one.

Inbound rules (2)

| Security group rule ID | IP version |Type    | Prtocols |Port range |  Source    |
| --------               | -------    |------- | -------  |-------    |  -------   |
| sgr-07be979155e41d41d  | IPv4       |HTTP    | TCP      | 443       | 0.0.0.0/0  |
| sgr-0b96586483f35efce  | IPv4       |HTTPS   | TCP      | 80        | 0.0.0.0/0  |

Outbound rules (1) (2)

| Security group rule ID | IP version |Type    | Prtocols |Port range |  Destination    |
| --------               | -------    |------- | -------  |-------    |  -------   |
| sgr-02f26565ce1f77104  | IPv4       |All traffic    | All      | All       | 0.0.0.0/0  |


## BootStrap Scripts

1. A script that runs when the instance first runs.

```bash
#!/bin/bash
yum update -y
yum install httpd -y
systemctl start httpd
systemctl enable httpd
cd /var/www/html
echo "<html><body><h1>Hello Cloud Gurus</h1></body></html>" > index.html
```

1. Paste the above details when creating EC2 Server -> Advanced details
1. Use the above security group.
1. Once hte EC2 Server starts , navigate to instance -> Networking -> Copy `Public IPv4 address` -> Paste in browser and voila we see the message `Hello Cloud Gurus`

## EC2 Metadata

1. Public IPv4 address,Private IPv4 addresses,hostname,security group etc..
1. Using curl command we can query metadata about our EC2 instance.

## EC2 Networking

1. WE can have 3 different types of virtual networrking cards to our EC2 Instances
1. ENI -> Elastic Network Interface -> Basic, day to day networking
    - Virtual network card that allows Private,Public IPv4 addresses.
    - Many IPv6 Addresses
    - MAC address
    - 1 or more security groups.
    - Uses -> Management Network, low budget.  
1. EN -> Enhanced Networking -> Uses single root I/O virtualization to provide high performance
    - 10 Gbps - 100 Gbps 
    - Comes in diff flavors 
        - 🛑 Elastic Network Adapter `ENA` -> Supports upto 100 Gbps
        - Intel 82599 Virtual Function (VF) Interface  -> Upto 10 Gbps ( Typically used on older instances)
1. EFA -> Elastic Fabric Adapter -> Accelerate High Performance Computing ( HPC ) and machine learning applications.
    - Lower & more consistent latency
    - 🛑 Can use OS-BYPASS ( Only on Linux )


## EC2 Placement groups

1. Cluster Placement Group -> Grouping of instance within single AZ. Recommended for apps that need low network latency,high network throughput or both.
1. 